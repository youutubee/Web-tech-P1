<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Destinations — VoyageFlow</title>

    <!-- Bootstrap 5.2.0 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/components.css" />
  </head>
  <body>
    <!-- Progress Bar -->
    <div class="progress-container">
      <div id="progressBar" class="progress-bar" style="width: 40%"></div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
      <div class="container">
        <div class="navbar-wrapper">
          <a class="navbar-brand" href="index.html">
            <i class="fas fa-plane"></i> VoyageFlow
          </a>
          <button
            class="navbar-toggler"
            type="button"
            aria-label="Toggle navigation"
          >
            <i class="fas fa-bars"></i>
          </button>
          <ul class="navbar-nav">
            <li>
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-dropdown">
              <a
                class="nav-dropdown-toggle"
                href="javascript:void(0)"
                aria-expanded="false"
              >
                Destinations <i class="fas fa-chevron-down"></i>
              </a>
              <div class="nav-dropdown-menu">
                <a class="nav-dropdown-item" href="destinations.html"
                  >Browse All</a
                >
              </div>
            </li>
            <li>
              <a class="nav-link" href="login.html">Login</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Destinations Section -->
    <section class="section">
      <div class="container">
        <div class="section-title">
          <h2>Choose Your Destination</h2>
          <p>Select your dream destination to continue</p>
        </div>
        <div class="row g-4" id="destinationGrid">
          <!-- Destination cards will be populated by JavaScript -->
        </div>
        <div class="text-center mt-5">
          <button
            id="nextToBooking"
            class="btn-primary btn-lg disabled"
            disabled
          >
            Continue to Booking <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="row">
          <div class="col-md-4 mb-4">
            <h5>VoyageFlow</h5>
            <p>
              Your trusted partner for planning amazing travel experiences
              around the world.
            </p>
            <div class="social-icons">
              <a href="#"><i class="fab fa-facebook-f"></i></a>
              <a href="#"><i class="fab fa-twitter"></i></a>
              <a href="#"><i class="fab fa-instagram"></i></a>
              <a href="#"><i class="fab fa-linkedin-in"></i></a>
            </div>
          </div>
          <div class="col-md-4 mb-4">
            <h5>Quick Links</h5>
            <ul class="navbar-nav footer-nav">
              <li>
                <a class="nav-link" href="index.html">Home</a>
              </li>
              <li>
                <a class="nav-link" href="destinations.html">Destinations</a>
              </li>
              <li>
                <a class="nav-link" href="login.html">Login</a>
              </li>
            </ul>
          </div>
          <div class="col-md-4 mb-4">
            <h5>Contact</h5>
            <p><i class="fas fa-envelope"></i> info@voyageflow.com</p>
            <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2025VoyageFlow. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Destination Data -->
    <script src="data/destinations.js"></script>

    <!-- Utility Functions -->
    <script src="js/utils.js"></script>

    <!-- Navigation -->
    <script src="js/navigation.js"></script>

    <!-- Page Scripts -->
    <script src="js/pages/destination-selection.js"></script>

    <!-- Initialize Destination Selection -->
    <script>
      // Make destinationsData globally available
      window.destinationsData =
        typeof destinationsData !== "undefined" ? destinationsData : {};

      // Populate destination cards
      function populateDestinationCards() {
        const grid = document.getElementById("destinationGrid");
        if (
          grid &&
          window.destinationsData &&
          Object.keys(window.destinationsData).length > 0
        ) {
          grid.innerHTML = ""; // Clear existing
          Object.keys(window.destinationsData).forEach((key) => {
            const dest = window.destinationsData[key];
            const col = document.createElement("div");
            col.className = "col-md-4";
            col.innerHTML = `
              <div class="destination-card" data-destination="${key}">
                <img src="${
                  dest.image
                }" class="destination-card-img" alt="${dest.name}">
                <div class="destination-card-body">
                  <h3 class="destination-card-title">${dest.name}</h3>
                  <p class="destination-card-text">${dest.description}</p>
                  <div class="destination-card-footer">
                    <span class="destination-price">From ${formatCurrency(
                      dest.basePrice
                    )}</span>
                    <span class="destination-rating">⭐ 4.8</span>
                  </div>
                  <button class="btn-select-destination btn-primary btn-sm" data-destination="${key}">
                    <i class="fas fa-check"></i> Select
                  </button>
                </div>
              </div>
            `;
            grid.appendChild(col);
          });
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        updateProgressBarAuto();

        // Wait for destinationsData to load
        if (typeof destinationsData !== "undefined") {
          window.destinationsData = destinationsData;
          populateDestinationCards();
          setTimeout(() => {
            if (typeof initDestinationSelection === "function") {
              initDestinationSelection();
            }
          }, 100);
        } else {
          // Try again after a short delay
          setTimeout(() => {
            if (typeof destinationsData !== "undefined") {
              window.destinationsData = destinationsData;
              populateDestinationCards();
              setTimeout(() => {
                if (typeof initDestinationSelection === "function") {
                  initDestinationSelection();
                }
              }, 100);
            }
          }, 100);
        }

        // Handle continue to booking button
        const nextBtn = document.getElementById("nextToBooking");
        if (nextBtn) {
          nextBtn.addEventListener("click", () => {
            const selectedDestination = localStorage.getItem("selectedDestination");
            if (selectedDestination) {
              window.location.href = `booking.html?destination=${selectedDestination}`;
            }
          });
        }
      });
    </script>
  </body>
</html>

